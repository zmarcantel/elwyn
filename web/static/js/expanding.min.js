(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){function i(e){if(window.console&&console.warn)console.warn(e)}var t=function(n,r){t._registry.push(this);this.$textarea=n;this.$textCopy=e("<span />");this.$clone=e("<pre class='expanding-clone'><br /></pre>").prepend(this.$textCopy);this._resetStyles();this._setCloneStyles();this._setTextareaStyles();n.wrap(e("<div class='expanding-wrapper' style='position:relative' />")).after(this.$clone);this.attach();this.update();if(r.update)n.bind("update.expanding",r.update)};t._registry=[];t.getExpandingInstance=function(n){var r=e.map(t._registry,function(e){return e.$textarea[0]}),i=e.inArray(n,r);return i>-1?t._registry[i]:null};var n=function(){var e=-1;if(navigator.appName==="Microsoft Internet Explorer"){var t=navigator.userAgent;var n=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");if(n.exec(t)!==null)e=parseFloat(RegExp.$1)}return e}();var r="oninput"in document.createElement("input")&&n!==9;t.prototype={attach:function(){var e="input.expanding change.expanding",t=this;if(!r)e+=" keyup.expanding";this.$textarea.bind(e,function(){t.update()})},update:function(){this.$textCopy.text(this.$textarea.val().replace(/\r\n/g,"\n"));this.$textarea.triggerHandler("update.expanding")},destroy:function(){this.$clone.remove();this.$textarea.unwrap().attr("style",this._oldTextareaStyles||"");delete this._oldTextareaStyles;var n=e.inArray(this,t._registry);if(n>-1)t._registry.splice(n,1);this.$textarea.unbind("input.expanding change.expanding keyup.expanding update.expanding")},_resetStyles:function(){this._oldTextareaStyles=this.$textarea.attr("style");this.$textarea.add(this.$clone).css({margin:0,webkitBoxSizing:"border-box",mozBoxSizing:"border-box",boxSizing:"border-box",width:"100%"})},_setCloneStyles:function(){var e={display:"block",border:"0 solid",visibility:"hidden",minHeight:this.$textarea.outerHeight()};if(this.$textarea.attr("wrap")==="off")e.overflowX="scroll";else e.whiteSpace="pre-wrap";this.$clone.css(e);this._copyTextareaStylesToClone()},_copyTextareaStylesToClone:function(){var t=this,n=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","maxHeight"];e.each(n,function(e,n){var r=t.$textarea.css(n);if(t.$clone.css(n)!==r){t.$clone.css(n,r);if(n==="maxHeight"&&r!=="none"){t.$clone.css("overflow","hidden")}}})},_setTextareaStyles:function(){this.$textarea.css({position:"absolute",top:0,left:0,height:"100%",resize:"none",overflow:"auto"})}};e.expanding=e.extend({autoInitialize:true,initialSelector:"textarea.expanding",opts:{update:function(){}}},e.expanding||{});e.fn.expanding=function(n){if(n==="destroy"){this.each(function(){var e=t.getExpandingInstance(this);if(e)e.destroy()});return this}if(n==="active"){return!!this.filter(function(){return!!t.getExpandingInstance(this)}).length}var r=e.extend({},e.expanding.opts,n);this.filter("textarea").each(function(){var n=this.offsetWidth>0||this.offsetHeight>0,s=t.getExpandingInstance(this);if(n&&!s)new t(e(this),r);else{if(!n)i("ExpandingTextareas: attempt to initialize an invisible textarea. Call expanding() again once it has been inserted into the page and/or is visible.");if(s)i("ExpandingTextareas: attempt to initialize a textarea that has already been initialized. Subsequent calls are ignored.")}});return this};e(function(){if(e.expanding.autoInitialize){e(e.expanding.initialSelector).expanding()}})})
